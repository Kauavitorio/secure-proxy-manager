[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/var/run/supervisord.pid
user=root

[program:squid]
command=/usr/sbin/squid -f /etc/squid/squid.conf
user=root
autostart=true
autorestart=true
stdout_logfile=/var/log/squid/squid_stdout.log
stderr_logfile=/var/log/squid/squid_stderr.log
redirect_stderr=true
priority=10
startretries=3
startsecs=5
stopsignal=TERM

[program:flask]
command=python3 /app/flask_backend/app.py
directory=/app
environment=FLASK_APP="app.py",FLASK_ENV="production",PYTHONPATH="/app",FLASK_PORT="5000",BASE_DIR="/app",SQUID_CONFIG_DIR="/etc/squid",DASHBOARD_DIR="/app/dashboard",RUNNING_IN_DOCKER="true"
autostart=true
autorestart=true
stdout_logfile=/var/log/flask.log
stderr_logfile=/var/log/flask_error.log
redirect_stderr=true
priority=20
startretries=5
startsecs=5